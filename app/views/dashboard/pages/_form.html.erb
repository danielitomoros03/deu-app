<%= form_with(model: [:dashboard, page], class: "form-container") do |form| %>
  <% if page.errors.any? %>
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <i class="fas fa-exclamation-triangle me-2"></i>
      <h5 class="alert-heading mb-2">
        <%= pluralize(page.errors.count, "error") %> impidieron guardar esta página:
      </h5>
      <ul class="mb-0">
        <% page.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  <% end %>

  <div class="card border-0 shadow-sm mb-4">
    <div class="card-header bg-white border-0 py-3">
      <h5 class="mb-0">
        <i class="fas fa-info-circle text-primary me-2"></i>Información Básica
      </h5>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <!-- Nombre -->
        <div class="col-md-12">
          <div class="form-group">
            <%= form.label :name, "Nombre de la Página", class: "form-label fw-bold text-dark mb-2" %>
            <%= form.text_field :name, class: "form-control form-control-lg", placeholder: "Ingrese el nombre de la página..." %>
            <small class="form-text text-muted">Este será el título principal de la página.</small>
          </div>
        </div>

        <!-- Descripción Corta -->
        <div class="col-md-12">
          <div class="form-group">
            <%= form.label :short_description, "Descripción Corta", class: "form-label fw-bold text-dark mb-2" %>
            <%= form.text_area :short_description, class: "form-control", rows: 3, placeholder: "Ingrese una descripción breve de la página..." %>
            <small class="form-text text-muted">Esta descripción aparecerá en listados y resúmenes.</small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card border-0 shadow-sm mb-4">
    <div class="card-header bg-white border-0 py-3">
      <h5 class="mb-0">
        <i class="fas fa-tags text-primary me-2"></i>Clasificación
      </h5>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <!-- Grupo -->
        <div class="col-md-6">
          <div class="form-group">
            <%= form.label :group, "Grupo", class: "form-label fw-bold text-dark mb-2" %>
            <%= form.select :group, 
                options_for_select(
                  Page.groups.map { |key, value| [key.humanize, key] },
                  page.group
                ), 
                { include_blank: "Seleccione un grupo..." }, 
                class: "form-select" 
            %>
            <small class="form-text text-muted">Categoría principal de la página.</small>
          </div>
        </div>

        <!-- Subgrupo -->
        <div class="col-md-6">
          <div class="form-group">
            <%= form.label :subgroup, "Subgrupo", class: "form-label fw-bold text-dark mb-2" %>
            <%= form.select :subgroup, 
                options_for_select(
                  Page.subgroups.map { |key, value| [key.humanize, key] },
                  page.subgroup
                ), 
                { include_blank: "Seleccione un subgrupo..." }, 
                class: "form-select" 
            %>
            <small class="form-text text-muted">Subcategoría específica de la página.</small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Actions -->
  <div class="card border-0 shadow-sm">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <%= link_to dashboard_pages_path, class: "btn btn-outline-secondary" do %>
            <i class="fas fa-arrow-left me-2"></i>Volver al Listado
          <% end %>
        </div>
        <div class="d-flex gap-2">
          <% if page.persisted? %>
            <%= link_to dashboard_page_path(page), class: "btn btn-outline-primary", title: "Ver página" do %>
              <i class="fas fa-eye me-2"></i>Ver
            <% end %>
          <% end %>
          
          <%= form.button type: "submit", class: "btn btn-primary" do %>
            <i class="fas fa-save me-2"></i>
            <%= page.persisted? ? "Actualizar Página" : "Crear Página" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
<% end %>

<style>
.form-container {
  max-width: 100%;
}

.form-group {
  margin-bottom: 1.5rem;
}

.form-label {
  font-size: 0.9rem;
}

.form-control, .form-select {
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 0.75rem 1rem;
  transition: all 0.2s ease-in-out;
}

.form-control:focus, .form-select:focus {
  border-color: #0d6efd;
  box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.1);
}

.form-control-lg {
  font-size: 1.1rem;
  font-weight: 500;
}

.form-text {
  font-size: 0.8rem;
  margin-top: 0.25rem;
}

.card {
  border-radius: 12px;
}

.card-header {
  border-bottom: 1px solid #f1f5f9;
}

.btn {
  border-radius: 8px;
  padding: 0.75rem 1.5rem;
  font-weight: 500;
  transition: all 0.2s ease-in-out;
}

.btn-primary {
  background-color: #0d6efd;
  border-color: #0d6efd;
}

.btn-primary:hover {
  background-color: #0b5ed7;
  border-color: #0a58ca;
  transform: translateY(-1px);
}

.alert {
  border-radius: 12px;
  border: none;
}

.alert-danger {
  background-color: rgba(220, 53, 69, 0.1);
  color: #dc3545;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Agregar estilos dinámicos a los selects
  const selects = document.querySelectorAll('.form-select');
  selects.forEach(select => {
    select.addEventListener('change', function() {
      if (this.value) {
        this.style.backgroundColor = '#f8f9fa';
      } else {
        this.style.backgroundColor = '';
      }
    });
    
    // Aplicar estilo inicial
    if (select.value) {
      select.style.backgroundColor = '#f8f9fa';
    }
  });
});
</script>