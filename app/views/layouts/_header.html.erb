<!-- Header/Navbar -->
<header class="main-header sticky-top bg-white shadow-sm">
    <div class="container">
        <nav class="navbar navbar-expand-lg navbar-light pb-3">
            <%= link_to dashboard_index_path, class: "navbar-brand d-flex align-items-center gap-3" do %>
                <div class="logo-circle">
                    <span>
                        <%= image_tag("favicon.png") %>
                    </span>
                </div>
                <div class="logo-text">
                    <div class="logo-title">DEU - UCV</div>
                    <div class="logo-subtitle d-none d-sm-block">Universidad Central de Venezuela</div>
                </div>
            <% end %>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-lg-center">
                    <hr>
                    <li class="nav-item d-block d-lg-none d-ms-block">
                        <%= link_to "Páginas", dashboard_pages_path, class: "nav-link" %>
                    </li>
                    <li class="nav-item d-block d-lg-none d-ms-block">
                        <%= link_to "Crear nueva página", new_dashboard_page_path, class: "nav-link" %>
                    </li>
                    <li class="nav-item d-block">
                        <!-- Usuario -->
                        <div class="dropdown">
                            <button class="btn btn-link text-dark d-flex align-items-center text-decoration-none p-0" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <div class="avatar-circle me-2">
                                <% if current_user.email.present? %>
                                    <%= current_user.email.first.upcase %>
                                <% else %>
                                    U
                                <% end %>
                            </div>
                            <span class="d-print-inline d-xl-inline me-2">
                                <% if current_user.email.present? %>
                                    <%= current_user.email.split('@').first %>
                                <% end %>
                            </span>
                            <i class="fas fa-chevron-down small"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="userDropdown" style="min-width: 250px;">
                            <li>
                                <div class="dropdown-header">
                                    <div class="d-flex align-items-center">
                                        <div class="avatar-circle-large me-3">
                                        <% if current_user.email.present? %>
                                            <%= current_user.email.first.upcase %>
                                        <% else %>
                                            U
                                        <% end %>
                                        </div>
                                        <div>
                                            <div class="fw-bold"><%= current_user.email.split('@').first if current_user.email %></div>
                                            <div class="small text-muted"><%= current_user.email %></div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                                <li>
                                    <%= link_to destroy_user_session_path, data: { turbo_method: :delete }, class: "dropdown-item text-danger" do %>
                                        <i class="fas fa-sign-out-alt me-2"></i> Cerrar sesión
                                    <% end %>
                                </li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </nav>
    </div>
</header>

<style>
  .topbar {
    position: sticky;
    top: 0;
    z-index: 1020;
    border-bottom: 1px solid #e5e7eb;
  }

  .avatar-circle {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, #01695b 0%, #2599ebff 100%);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 1rem;
  }

  .avatar-circle-large {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #01695b 0%, #2599ebff 100%);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.25rem;
  }

  /* Asegurar que los dropdowns tengan buen estilo */
  .dropdown-menu {
    border: 1px solid #e5e7eb;
  }

  .dropdown-item:hover {
    background-color: #f3f4f6;
  }

  /* Espaciado del menú móvil */
  @media (max-width: 991.98px) {
    #navbarNav {
      margin-top: 1rem;
    }
    
    #navbarNav .navbar-nav {
      padding: 0.5rem 0;
    }
    
    #navbarNav .nav-item {
      padding: 0.25rem 0;
    }

    #navbarNav .nav-link {
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      transition: background-color 0.2s;
    }

    #navbarNav .nav-link:hover {
      background-color: #f3f4f6;
    }
  }

  /* Animación del badge de notificaciones */
  .badge {
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.7;
    }
  }
</style>